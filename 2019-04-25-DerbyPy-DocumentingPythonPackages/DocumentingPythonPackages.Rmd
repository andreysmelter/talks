---
title: "Documenting Python Packages"
subtitle: "<font color='green'>Docs</font> or it didn't happen!"
author: "Andrey Smelter"
institute: "University of Kentucky<br>Markey Cancer Center"
date: "2019/04/11 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    css: ["default", "default-fonts", "resources/css/footer-header.css", "resources/css/my-theme.css", "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---


# <font color='green'>`$ whoami`</font>

### Andrey (pronounced similar to Andr√©) Smelter
### Postdoctoral Scholar at the <font color='blue'>University of Kentucky Markey Cancer Center</font>

### Links:
* <i class="fa fa-github"></i>: [github.com/andreysmelter](https://github.com/andreysmelter)
* <i class="fa fa-linkedin"></i>: [linkedin.com/in/andreysmelter](https://www.linkedin.com/in/andreysmelter/)
* <i class="fa fa-instagram"></i>: [instagram.com/andreysmelter](https://www.instagram.com/andreysmelter/)
* <i class="fa fa-twitter"></i>: [twitter.com/smelandr](https://twitter.com/smelandr)


---
background-image: url(resources/pics/WriteTheDocs.jpg)

<div class="my-footer">
    <span>
        <a href="https://twitter.com/ThatDocsLady/status/1115921726297247744">
            [Ref]: https://twitter.com/ThatDocsLady/status/1115921726297247744
        </a>
    </span>
</div>

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```


---
class: center, middle

## A regular slide with text or `code`.


---
class: inverse, center, middle

## A transition slide or terminal output.

![](resources/pics/TerminalSmall.gif)

<div class="my-footer">
    <span>
        <a href="">
            [Ref]: Click me!
        </a>
    </span>
</div>


---
class: center, middle

# Why write docs?

### You want <font color='green'>people to use</font> your code

### You want your <font color='green'>code to be better</font>

### You want <font color='green'>contributors</font>

### You will be using <font color='green'>your code in [X] months</font>


---
class: center, middle

# <font color='green'>*To document or not to document?*</font>

> "There is a magical feeling that happens when you release your code. 
  It comes in a variety of ways, but it always hits you the same. 
  <font color='green'>*Someone is using my code?!*</font> 
  A mix of terror and excitement."
  
<div class="my-footer">
    <span>
        <a href="https://www.writethedocs.org/guide/writing/beginners-guide-to-docs">
            [Ref]: https://www.writethedocs.org/guide/writing/beginners-guide-to-docs
        </a>
    </span>
</div>


---
class: inverse, center, top

background-image: url(resources/pics/MontyPythonAndTheHolyGrailNetflix.jpg)

# Get Started

### The Python Standard Library

<div class="my-footer">
    <span>
        <a href="https://www.netflix.com/title/771476">
            [Ref]: https://www.netflix.com/title/771476
        </a>
    </span>
</div>


---
class: center, middle

# <font color='green'>"Batteries Included"</font> Philosophy

### Having a <font color='green'>rich and versatile</font> standard library

### Which is <font color='green'>immediately available</font>

### <font color='green'>Without</font> making the user <font color='green'>download separate</font> packages

<div class="my-footer">
    <span>
        <a href="https://www.python.org/dev/peps/pep-0206">
            [Ref]: https://www.python.org/dev/peps/pep-0206
        </a>
    </span>
</div>


---
class: inverse, center, middle

# pydoc

### built-in


---
# pydoc

### The pydoc module <font color='green'>automatically</font> generates documentation from Python modules.

### The documentation can be presented as:

* pages of <font color='green'>**text on the console**</font>
* served to a <font color='green'>**web browser**</font>
* or saved to <font color='green'>**HTML files**</font>


<div class="my-footer">
    <span>
        <a href="https://docs.python.org/3/library/pydoc.html">
            [Ref]: https://docs.python.org/3/library/pydoc.html
        </a>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <a href="https://github.com/python/cpython/blob/3.7/Lib/pydoc.py">
            [Ref]: https://github.com/python/cpython/blob/3.7/Lib/pydoc.py
        </a>
    </span>
</div>


---
# Let's use quadratic equation as an example

--

* The <font color='green'>**quadratic equation**</font> formula: 

$$ax^2 + bx + c = 0$$

--
* The quadratic formula for the <font color='green'>**roots**</font>: 

$$x_{1,2}=\frac{-b \pm \sqrt{b^2-4ac} }{2a}$$

--
* The <font color='green'>`equations/quadratic.py`</font> module: 

```{python python.reticulate=FALSE}
import cmath


def quadratic(a, b, c):
    discriminant = cmath.sqrt(b**2.0 - 4.0 * a * c)
    x1 = (-b + discriminant) / (2.0 * a)
    x2 = (-b - discriminant) / (2.0 * a)
    return x1, x2
```

<div class="my-footer">
    <span>
        <a href="https://github.com/andreysmelter/talks/tree/master/2019-04-25-DerbyPy-DocumentingPythonPackages/examples/0_example">
            [Ref]: Example 0.
        </a>
    </span>
</div>


---
class: inverse

# pydoc

### The pydoc module <font color='green'>"automatically"</font> generates documentation from Python modules

```
$ python3 -m pydoc equations.quadratic
Help on module quadratic:

NAME
    quadratic

FUNCTIONS
    quadratic(a, b, c)

FILE
    /equations/quadratic.py
```


---
# pydoc

* Add <font color='green'>module-level</font> docstrig.
* Add <font color='green'>function-level</font> docstring.


```{python python.reticulate=FALSE}
"""
This module contains routines for finding 
roots of quadratic equations.
"""

import cmath


def quadratic(a, b, c):
    """Solve quadratic equation."""
    discriminant = cmath.sqrt(b**2.0 - 4.0 * a * c)
    x1 = (-b + discriminant) / (2.0 * a)
    x2 = (-b - discriminant) / (2.0 * a)
    return x1, x2
```

<div class="my-footer">
    <span>
        <a href="https://github.com/andreysmelter/talks/tree/master/2019-04-25-DerbyPy-DocumentingPythonPackages/examples/1_example">
            [Ref]: Example 1.
        </a>
    </span>
</div>


---
class: inverse

# pydoc

### The pydoc module <font color='green'>automatically</font> generates documentation from Python modules

```
$ python3 -m pydoc equations.quadratic

Help on module equations.quadratic in equations:

NAME
    equations.quadratic

DESCRIPTION
    This module contains routines for finding 
    roots of quadratic equations.

FUNCTIONS
    quadratic(a, b, c)
        Solve quadratic equation.

FILE
    /equations/quadratic.py
```

---
# pydoc

* **Package-level** docstring?


---
class: inverse

# pydoc

```
$ python3 -m pydoc equations

Help on package equations:

NAME
    equations

PACKAGE CONTENTS
    quadratic

FILE
    (built-in)
```


---
# pydoc

* Create <font color='green'>`equations/__init__.py`</font> file.

```{python python.reticulate=FALSE}
"""
This package provides routines for solving
equations.
"""


__author__ = "Andrey Smelter"
__version__ = "0.1.0"
```

<div class="my-footer">
    <span>
        <a href="https://github.com/andreysmelter/talks/tree/master/2019-04-25-DerbyPy-DocumentingPythonPackages/examples/2_example">
            [Ref]: Example 2.
        </a>
    </span>
</div>


---
class: inverse

# pydoc

```
$ python3 -m pydoc equations

Help on package equations:

NAME
    equations

DESCRIPTION
    This package provides routines for solving
    equations.

PACKAGE CONTENTS
    quadratic

VERSION
    0.1.0

AUTHOR
    Andrey Smelter

FILE
    /equations/__init__.py
```


---

# pydoc

* How about **static HTML** pages?


---
class: inverse

# pydoc

* How about **static HTML** pages?

```
$ python3 -m pydoc -w equations
$ python3 -m pydoc -w equations.quadratic
```

<div class="my-footer">
    <span>
        <a href="https://github.com/andreysmelter/talks/tree/master/2019-04-25-DerbyPy-DocumentingPythonPackages/examples/3_example">
            [Ref]: Example 3.
        </a>
    </span>
</div>


---

# pydoc

* Package-level doc:

![](resources/pics/pydocHTMLPackage.png)


---

# pydoc

* Module-level doc:

![](resources/pics/pydocHTMLModule.png)


---

# pydoc

### Pros:
* **Built-in** docs generator.
* Used by `>>> help()` function to pull and display docstrings 
  from functions/methods, modules, and packages.

### Cons:
* Static HTML docs are very **retro style**.


--

![](resources/pics/SeriousRetroEmojiSmall.jpg)


---
class: inverse, center, middle

# doctest

### built-in


---
# doctest

### Searches for pieces of text that <font color='green'>look like interactive Python sessions</font>. 
### Then <font color='green'>executes those sessions</font> to verify that they work exactly as shown.

<div class="my-footer">
    <span>
        <a href="https://docs.python.org/3/library/doctest.html">
            [Ref]: https://docs.python.org/3/library/doctest.html
        </a>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <a href="https://github.com/python/cpython/blob/3.7/Lib/doctest.py">
            [Ref]: https://github.com/python/cpython/blob/3.7/Lib/doctest.py
        </a>
    </span>
</div>


---
# doctest

```{python python.reticulate=FALSE}
def quadratic(a, b, c):
    """Solve quadratic equation.

    For example:
    >>> x1, x2 = quadratic(a=2, b=-8, c=-24)
    >>> x1
    (6+0j)
    >>> x2
    (-2+0j)
    >>> 2*x1**2 - 8*x1 - 24
    0j
    >>> 2*x2**2 - 8*x2 - 24
    0j
    """
    discriminant = cmath.sqrt(b**2.0 - 4.0 * a * c)
    x1 = (-b + discriminant) / (2.0 * a)
    x2 = (-b - discriminant) / (2.0 * a)
    return x1, x2

if __name__ == "__main__":
    import doctest
    print(doctest.testmod())
```

<div class="my-footer">
    <span>
        <a href="https://github.com/andreysmelter/talks/tree/master/2019-04-25-DerbyPy-DocumentingPythonPackages/examples/4_example/">
            [Ref]: Example 4.
        </a>
    </span>
</div>


---
class: inverse

# doctest

```
$ python3 -m equations.quadratic
TestResults(failed=0, attempted=5)
```


---
class: inverse

# doctest

<pre class="remark-code small-55">
$ python3 -m equations.quadratic -v
Trying:
    x1, x2 = quadratic(a=2, b=-8, c=-24)
Expecting nothing
ok
Trying:
    x1
Expecting:
    (6+0j)
ok
Trying:
    x2
Expecting:
    (-2+0j)
ok
Trying:
    2*x1**2 - 8*x1 - 24
Expecting:
    0j
ok
Trying:
    2*x2**2 - 8*x2 - 24
Expecting:
    0j
ok
1 items had no tests:
    __main__
1 items passed all tests:
   5 tests in __main__.quadratic
5 tests in 2 items.
5 passed and 0 failed.
Test passed.
TestResults(failed=0, attempted=5)
</pre>


---
# doctest

```{python python.reticulate=FALSE}
def quadratic(a, b, c):
    """Solve quadratic equation.

    For example:
    >>> x1, x2 = quadratic(a=2, b=-8, c=-24)
    >>> x1
    (8+0j)
    >>> x2
    (-2+0j)
    >>> 2*x1**2 - 8*x1 - 24
    0j
    >>> 2*x2**2 - 8*x2 - 24
    0j
    """
    discriminant = cmath.sqrt(b**2.0 - 4.0 * a * c)
    x1 = (-b + discriminant) / (2.0 * a)
    x2 = (-b - discriminant) / (2.0 * a)
    return x1, x2

if __name__ == "__main__":
    import doctest
    print(doctest.testmod())
```

<div class="my-footer">
    <span>
        <a href="https://github.com/andreysmelter/talks/tree/master/2019-04-25-DerbyPy-DocumentingPythonPackages/examples/5_example/">
            [Ref]: Example 5.
        </a>
    </span>
</div>


---
class: inverse

# doctest

```
$ python3 -m equations.quadratic
======================================================================
File "/equations/quadratic.py", line 14, in __main__.quadratic
Failed example:
    x1
Expected:
    (8+0j)
Got:
    (6+0j)
======================================================================
1 items had failures:
   1 of   5 in __main__.quadratic
Test Failed 1 failures.
TestResults(failed=1, attempted=5)
```


---
# doctest

```{python python.reticulate=FALSE, eval=FALSE}
def quadratic(a, b, c):
    """Solve quadratic equation.

    For example:
    >>> x1, x2 = quadratic(a=0, b=-8, c=-24)
    """
    discriminant = cmath.sqrt(b**2.0 - 4.0 * a * c)
    x1 = (-b + discriminant) / (2.0 * a)
    x2 = (-b - discriminant) / (2.0 * a)
    return x1, x2


if __name__ == "__main__":
    import doctest
    print(doctest.testmod())
```

<div class="my-footer">
    <span>
        <a href="https://github.com/andreysmelter/talks/tree/master/2019-04-25-DerbyPy-DocumentingPythonPackages/examples/6_example/">
            [Ref]: Example 6.
        </a>
    </span>
</div>


---
class: inverse

# doctest

```
$ python3 -m equations.quadratic
======================================================================
File "/equations/quadratic.py", line 13, in __main__.quadratic
Failed example:
    x1, x2 = quadratic(a=0, b=-8, c=-24)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib64/python3.5/doctest.py", line 1321, in __run
        compileflags, 1), test.globs)
      File "<doctest __main__.quadratic[0]>", line 1, in <module>
        x1, x2 = quadratic(a=0, b=-8, c=-24)
      File "equations/quadratic.py", line 16, in quadratic
        x1 = (-b + discriminant) / (2.0 * a)
    ZeroDivisionError: complex division by zero
======================================================================
1 items had failures:
   1 of   1 in __main__.quadratic
Test Failed 1 failures.
TestResults(failed=1, attempted=1)
```


---
# doctest

```{python python.reticulate=FALSE, eval=FALSE}
def quadratic(a, b, c):
    """Solve quadratic equation.

    For example:
    >>> x1, x2 = quadratic(a=0, b=-8, c=-24)
    Traceback (most recent call last):
    ...
    ZeroDivisionError: complex division by zero
    """
    discriminant = cmath.sqrt(b**2.0 - 4.0 * a * c)
    x1 = (-b + discriminant) / (2.0 * a)
    x2 = (-b - discriminant) / (2.0 * a)
    return x1, x2


if __name__ == "__main__":
    import doctest
    print(doctest.testmod())
```

<div class="my-footer">
    <span>
        <a href="https://github.com/andreysmelter/talks/tree/master/2019-04-25-DerbyPy-DocumentingPythonPackages/examples/7_example/">
            [Ref]: Example 7.
        </a>
    </span>
</div>


---
class: inverse

# doctest

```
$ python3 -m equations.quadratic -v
Trying:
    x1, x2 = quadratic(a=0, b=-8, c=-24)
Expecting:
    Traceback (most recent call last):
    ...
    ZeroDivisionError: complex division by zero
ok
1 items had no tests:
    __main__
1 items passed all tests:
   1 tests in __main__.quadratic
1 tests in 2 items.
1 passed and 0 failed.
Test passed.
TestResults(failed=0, attempted=1)
```


---
# doctest

### Pros:
* **Built-in** docs string test.
* Forces you to write **high-quality examples** in your doc strings.
* Makes sure that your doc string is **up-to-date**.

### Cons:
* May not be useful for more **complex cases**.

<div class="my-footer">
    <span>
        <a href="https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/linear_model/bayes.py#L113">
            [Ref]: doctest example from scikit-learn machine learning library.
        </a>
    </span>
</div>


---
class: inverse, center, bottom

background-image: url(resources/pics/CheeseShop.png)

# a.k.a. Python Package Index (PyPI)

<div class="my-footer">
    <span>
        <a href="https://wiki.python.org/moin/CheeseShop">
            [Ref]: https://wiki.python.org/moin/CheeseShop
        </a>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <a href="https://youtu.be/uT3OQECSDoQ">
            [Ref]: https://youtu.be/uT3OQECSDoQ
        </a>
    </span>
</div>


